pipeline {
    agent any
    parameters { 
       choice(name: 'file_name', choices: ['all', 'c', 'java', 'python'], description: 'Select the file you want to execute')
       string(name: 'con_name', defaultValue: 'project', description: 'Name of the container')
       string(name: 'port', defaultValue: '8998', description: 'Port to map the container')
    }
    stages {
        stage('GITHUB') {
            steps {
                git url: 'https://github.com/yossiazu/t1.git', branch: 'main'
                sh 'pwd'
                sh 'ls -la'
            }
        }
        stage('look fo the file') {
            steps{ 
                sh'''
                if [ "$params.file_name" = "all" ]; then
                  cp all index.html
                elif [ "$params.file_name" = java ]; then
                   cp java index.html
                elif [ "$params.file_name" = "python" ]; then
                   cp python index.html
                elif [ "$params.file_name" = "c" ]; then
                   cp c index.html
                fi
                docker build -t my-apache2 .
                docker run -dit --name $params.con_name -p $params.port:80 my-apache2
                '''
                
            }
        }
    }
    post {
        success {
            mail to: "yossi1999azu@gmail.com",
                 subject: "the build was successful",
                 body: "the selected language is: $file"
        }
    }
}
